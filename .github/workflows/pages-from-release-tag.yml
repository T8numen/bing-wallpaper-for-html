name: Deploy lockscreen.html from latest release tag to Pages

on:
  release:
    types: [published] # 发布/更新 release 时触发 :contentReference[oaicite:1]{index=1}

permissions:
  contents: read
  pages: write
  id-token: write
  actions: read   # deploy-pages@v4 某些版本需要 :contentReference[oaicite:2]{index=2}

concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the release tag
        uses: actions/checkout@v4
        with:
          # release 事件下建议用 tag_name 更稳 :contentReference[oaicite:3]{index=3}
          ref: ${{ github.event.release.tag_name }}

      - name: Prepare site
        run: |
          mkdir -p site
          # 如果你希望根路径直接打开页面，把它变成 index.html
          cp lockscreen.html site/index.html
          # 如果你希望保留 /lockscreen.html：
          # cp lockscreen.html site/lockscreen.html

      - name: Configure Pages
        uses: actions/configure-pages@v5 :contentReference[oaicite:4]{index=4}

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: site :contentReference[oaicite:5]{index=5}

  deploy:
    runs-on: ubuntu-latest
    needs: build
    environment:
      name: github-pages
    steps:
      - name: Deploy to GitHub Pages
        uses: actions/deploy-pages@v4 :contentReference[oaicite:6]{index=6}
